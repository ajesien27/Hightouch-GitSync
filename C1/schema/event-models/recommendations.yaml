name: RECOMMENDATIONS
source: Snowflake-86dba
type: raw_sql
rawSql: |-
  SELECT
    EVENT_ID AS REC_ID,
    ESCID,
    CAMPAIGN AS TEMPLATE_ID,
    MKT_CHANNEL_PROPENSITY AS CHANNEL,
    CASE
      WHEN ESCID > 1000000000
      AND ESCID < 1010000000 THEN TIMESTAMP '2025-10-15 01:00:00'
      WHEN ESCID > 1010000000
      AND ESCID < 1020000000 THEN TIMESTAMP '2025-10-15 02:00:00'
      WHEN ESCID > 1020000000
      AND ESCID < 1030000000 THEN TIMESTAMP '2025-10-15 03:00:00'
      WHEN ESCID > 1030000000
      AND ESCID < 1040000000 THEN TIMESTAMP '2025-10-15 04:00:00'
      WHEN ESCID > 1040000000
      AND ESCID < 1050000000 THEN TIMESTAMP '2025-10-15 05:00:00'
      WHEN ESCID > 1050000000
      AND ESCID < 1060000000 THEN TIMESTAMP '2025-10-15 06:00:00'
      WHEN ESCID > 1060000000
      AND ESCID < 1070000000 THEN TIMESTAMP '2025-10-15 07:00:00'
      WHEN ESCID > 1070000000
      AND ESCID < 1080000000 THEN TIMESTAMP '2025-10-15 08:00:00'
      ELSE TIMESTAMP '2025-10-14 08:00:00'
    END AS scheduled_timestamp
  FROM
    "PUBLIC"."EVENTS"
tableName: PUBLIC.EVENTS
eventTimestampColumn: SCHEDULED_TIMESTAMP
